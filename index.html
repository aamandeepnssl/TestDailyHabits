<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Habit Tracker</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    
    <style>
        :root {
            --bg-dark: #1a1a1a;
            --panel-grey: #2d2d2d;
            --text-light: #e0e0e0;
            --olive: #708238;
            --orange: #ff8c00;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--bg-dark); 
            color: var(--text-light);
            margin: 0; padding: 20px;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px; margin-bottom: 30px;
        }

        .stat-card {
            background: var(--panel-grey);
            padding: 20px;
            border-radius: 10px;
            border-top: 4px solid var(--orange);
            text-align: center;
        }

        .stat-card h3 { color: var(--olive); margin: 0; font-size: 0.9rem; }
        .stat-card p { font-size: 1.8rem; font-weight: bold; margin: 5px 0 0; }

        .task-container {
            background: var(--panel-grey);
            padding: 20px;
            border-radius: 12px;
            max-width: 600px;
            margin: 0 auto;
        }

        .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
        
        input[type="text"] {
            flex: 1; padding: 10px; background: #3d3d3d; border: none;
            color: white; border-radius: 5px;
        }

        button.add-btn {
            background: var(--olive); color: white; border: none;
            padding: 10px 20px; border-radius: 5px; cursor: pointer;
        }

        .task-item {
            display: flex; align-items: center; justify-content: space-between;
            background: #333; padding: 12px; margin-bottom: 8px; border-radius: 6px;
        }

        input[type="checkbox"] { accent-color: var(--orange); transform: scale(1.5); }
        
        .delete-btn { color: #ff4444; cursor: pointer; background: none; border: none; }
    </style>
</head>
<body>

    <div style="max-width: 800px; margin: 0 auto;">
        <h1 style="color: var(--orange)">Personal Dashboard</h1>

        <div class="dashboard">
            <div class="stat-card">
                <h3>Completion</h3>
                <p id="percent">0%</p>
            </div>
            <div class="stat-card">
                <h3>Tasks Done</h3>
                <p id="count">0/0</p>
            </div>
        </div>

        <div class="task-container">
            <div class="input-group">
                <input type="text" id="taskInput" placeholder="Add a new habit...">
                <button class="add-btn" onclick="addTask()">Add Task</button>
            </div>
            <div id="taskList"></div>
        </div>
    </div>

    <script>
        // 1. FIREBASE CONFIG (Paste your keys here again)
        const firebaseConfig = {
            apiKey: "AIzaSyCP8ZsngB137J1q186KHYeQKsIXzTbq580",
            authDomain: "mydailyhabits-5b16d.firebaseapp.com",
            databaseURL: "https://mydailyhabits-5b16d-default-rtdb.firebaseio.com",
            projectId: "mydailyhabits-5b16d",
            storageBucket: "mydailyhabits-5b16d.firebasestorage.app",
            messagingSenderId: "50093682600",
            appId: "1:50093682600:web:26644d7a3deb366ee3379d"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // 2. Add New Task
        function addTask() {
            const input = document.getElementById('taskInput');
            if(input.value === "") return;

            const newTask = {
                id: Date.now(),
                text: input.value,
                completed: false
            };

            // Get current tasks, add new one, save
            db.ref('habitTracker/tasks').once('value').then(snapshot => {
                const tasks = snapshot.val() || [];
                tasks.push(newTask);
                db.ref('habitTracker/tasks').set(tasks);
                input.value = "";
            });
        }

        // 3. Delete Task
        function deleteTask(id) {
            db.ref('habitTracker/tasks').once('value').then(snapshot => {
                const tasks = snapshot.val() || [];
                const updatedTasks = tasks.filter(t => t.id !== id);
                db.ref('habitTracker/tasks').set(updatedTasks);
            });
        }

        // 4. Toggle Task Checkbox
        function toggleTask(id) {
            db.ref('habitTracker/tasks').once('value').then(snapshot => {
                const tasks = snapshot.val() || [];
                const task = tasks.find(t => t.id === id);
                if(task) task.completed = !task.completed;
                db.ref('habitTracker/tasks').set(tasks);
            });
        }

        // 5. Listen for Sync and Update UI
        db.ref('habitTracker/tasks').on('value', (snapshot) => {
            const tasks = snapshot.val() || [];
            const list = document.getElementById('taskList');
            list.innerHTML = "";

            let completedCount = 0;

            tasks.forEach(task => {
                if(task.completed) completedCount++;
                list.innerHTML += `
                    <div class="task-item">
                        <div style="display:flex; align-items:center; gap:15px;">
                            <input type="checkbox" ${task.completed ? 'checked' : ''} onclick="toggleTask(${task.id})">
                            <span style="${task.completed ? 'text-decoration: line-through; color: #888' : ''}">${task.text}</span>
                        </div>
                        <button class="delete-btn" onclick="deleteTask(${task.id})">âœ•</button>
                    </div>
                `;
            });

            // Update Dashboard Metrics
            const percent = tasks.length > 0 ? Math.round((completedCount / tasks.length) * 100) : 0;
            document.getElementById('percent').innerText = percent + "%";
            document.getElementById('count').innerText = `${completedCount}/${tasks.length}`;
        });
    </script>
</body>
</html>
